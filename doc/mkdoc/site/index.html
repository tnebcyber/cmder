<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>FormCMS - Opensource Headless CMS powered with Asp.net Core(c#) and React, featuring Rest APIs, GraphQL and GraphJS page designer.</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/fontawesome.min.css" rel="stylesheet">
        <link href="css/brands.min.css" rel="stylesheet">
        <link href="css/solid.min.css" rel="stylesheet">
        <link href="css/v4-font-face.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body class="homepage">
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href=".">FormCMS - Opensource Headless CMS powered with Asp.net Core(c#) and React, featuring Rest APIs, GraphQL and GraphJS page designer.</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#what-is-formcms" class="nav-link">What is FormCMS?</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#new-cms-data-modeling" class="nav-link">New CMS? ‚Äî Data Modeling</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#new-cms-graphql-issues" class="nav-link">New CMS? ‚Äî GraphQL Issues</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#online-course-system-demo" class="nav-link">Online Course System Demo</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#online-course-system-backend" class="nav-link">Online Course System Backend</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#admin-panel" class="nav-link">Admin Panel</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#publish-preview-content" class="nav-link">Publish / Preview Content</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#concurrent-update-protection" class="nav-link">Concurrent Update Protection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#audit-logging" class="nav-link">Audit Logging</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#export-and-import-data" class="nav-link">Export and Import Data</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#asset-library" class="nav-link">Asset Library</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#graphql-query" class="nav-link">GraphQL Query</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#drag-and-drop-page-designer" class="nav-link">Drag and Drop Page Designer</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#schema-version-control" class="nav-link">Schema Version Control</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#online-course-system-frontend" class="nav-link">Online Course System Frontend</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#navigation-by-category" class="nav-link">Navigation by Category</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#optimizing-caching" class="nav-link">Optimizing Caching</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#aspire-integration" class="nav-link">Aspire Integration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#query-with-document-db" class="nav-link">Query with Document DB</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#integrating-it-into-your-project" class="nav-link">Integrating it into Your Project</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#adding-business-logic" class="nav-link">Adding Business Logic</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#development-guide" class="nav-link">Development Guide</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#testing-strategy" class="nav-link">Testing Strategy</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>Welcome to <a href="https://github.com/FormCMS/FormCMS">FormCMS</a>! üöÄ<br />
<a href="https://github.com/FormCMS/FormCMS/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/FormCMS/FormCMS.svg?style=social&amp;label=Star" /></a></p>
<p>Our mission is to make <strong>data modeling</strong>, <strong>backend development</strong>, and <strong>frontend development</strong> as simple and intuitive as filling out a <strong>form</strong> üìã<br />
We‚Äôd love for you to contribute to FormCMS! Check out our <a href="https://github.com/formcms/formcms/blob/main/CONTRIBUTING.md">CONTRIBUTING guide</a> to get started.<br />
Love FormCMS? Show your support by giving us a ‚≠ê on GitHub and help us grow! üåü<br />
Have suggestions? Connect with us on Reddit! https://www.reddit.com/r/FormCMS/</p>
<hr />
<h2 id="what-is-formcms">What is  FormCMS?</h2>
<p><strong>FormCMS</strong> is an open-source Content Management System designed to simplify and speed-up web development workflows. While it's particularly suited for CMS projects, it is also highly beneficial for general web applications, reducing the need for repetitive REST/GraphQL API development.</p>
<ul>
<li>
<p><strong>CRUD Operations:</strong>  FormCMS includes built-in RESTful APIs for Create, Read, Update, and Delete (CRUD) operations, complemented by a React-based admin panel for efficient data management.</p>
</li>
<li>
<p><strong>GraphQL Queries:</strong> Access multiple related entities in a single query, enhancing client-side performance, security, and flexibility.</p>
</li>
<li>
<p><strong>Grapes.js Page Designer:</strong> Build dynamic pages effortlessly using the integrated page designer powered by <a href="https://grapesjs.com/">Grapes.js</a> and <a href="https://handlebarsjs.com/">Handlebars</a>. Easily bind data sources for an interactive and streamlined design experience.</p>
</li>
</ul>
<hr />
<h2 id="new-cms-data-modeling">New CMS? ‚Äî Data Modeling</h2>
<h3 id="data-modeling-in-current-cms-solutions">Data Modeling in Current CMS Solutions</h3>
<p>Most CMS solutions support entity customization and adding custom properties, but they implement these changes in three distinct ways:</p>
<ol>
<li><strong>Denormalized Key-Value Storage</strong>: Custom properties are stored in a table with columns like ContentItemId, Key, and Value.</li>
<li><strong>JSON Data Storage</strong>: Some CMS platforms store custom properties as JSON data in a document database, while others use relational databases.</li>
<li><strong>Manually Created C# Classes</strong>: Writing code adds custom properties to create classes that the system uses with Entity Framework.</li>
</ol>
<h4 id="the-pros-and-cons">The Pros and Cons:</h4>
<ul>
<li><strong>Key-Value Storage</strong>: This approach offers flexibility but suffers from performance inefficiencies and lacks relational integrity.</li>
<li><strong>Document Database</strong>: Storing data as documents lacks a structured format and makes data integrity harder to enforce.</li>
<li><strong>C# Classes</strong>: While my preferred method, it lacks flexibility. Any minor changes require rebuilding and redeploying the system.</li>
</ul>
<h3 id="data-modeling-with-formcms">Data Modeling with FormCMS</h3>
<p>In contrast, FormCMS adopts a normalized, structured data approach, where each property is mapped to a corresponding table field:</p>
<ol>
<li><strong>Maximized Relational Database Functionality</strong>: By leveraging indexing and constraints, FormCMS enhances performance and ensures data integrity.</li>
<li><strong>Data Accessibility</strong>: This model allows for easy data integration with other applications, Entity Framework, or even non-C# languages.</li>
<li><strong>Support for Relationships</strong>: FormCMS enables complex relationships (many-to-one, one-to-many, many-to-many), making it easy to provide GraphQL Query out of the box and provide more advanced querying capabilities.</li>
</ol>
<hr />
<h2 id="new-cms-graphql-issues">New CMS? ‚Äî GraphQL Issues</h2>
<h3 id="key-challenges">Key Challenges</h3>
<ol>
<li><strong>Security &amp; Over-Fetching</strong> ‚Äì Complex or poorly optimized queries can overload the backend, exposing vulnerabilities and impacting performance.</li>
<li><strong>Caching Limitations</strong> ‚Äì GraphQL lacks built-in CDN caching, making performance optimization harder.</li>
<li><strong>N+1 Query Problem</strong> ‚Äì Individual resolver calls can lead to inefficient database queries.</li>
</ol>
<hr />
<h3 id="solution-persisted-queries-with-get-requests">Solution: Persisted Queries with GET Requests</h3>
<p>Many GraphQL frameworks support persisted queries with GET requests, enabling caching and improved performance.</p>
<hr />
<h3 id="how-formcms-solves-these-issues">How FormCMS Solves These Issues</h3>
<p>FormCMS automatically saves GraphQL queries and converts them into RESTful GET requests. For example:</p>
<pre><code class="language-graphql">query TeacherQuery($id: Int) {
  teacherList(idSet: [$id]) {
    id firstname lastname
    skills { id name }
  }
}
</code></pre>
<p>becomes <code>GET /api/queries/TeacherQuery</code>.</p>
<ul>
<li><strong>Security &amp; Efficiency</strong> ‚Äì Only Admins can define GraphQL queries, preventing abuse. Backend and frontend teams optimize queries to avoid excessive data requests.</li>
<li><strong>Caching</strong> ‚Äì GET requests enable efficient CDN caching, while ASP.NET Core‚Äôs hybrid cache further boosts performance.</li>
<li><strong>Performance</strong> ‚Äì Related entities are retrieved in a single optimized query, avoiding the N+1 problem.</li>
</ul>
<p>By transforming GraphQL into optimized REST-like queries, FormCMS ensures a secure, efficient, and scalable API experience.</p>
<hr />
<h2 id="online-course-system-demo">Online Course System Demo</h2>
<h3 id="live-demo">Live Demo</h3>
<ul>
<li><strong>Public Site:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/">fluent-cms-admin.azurewebsites.net</a></li>
<li><strong>Admin Panel:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/admin">fluent-cms-admin.azurewebsites.net/admin</a></li>
<li><strong>Email:</strong> <code>admin@cms.com</code></li>
<li><strong>Password:</strong> <code>Admin1!</code></li>
</ul>
<h3 id="additional-resources">Additional Resources</h3>
<ul>
<li><strong>GraphQL Playground:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/graph">fluent-cms-admin.azurewebsites.net/graph</a></li>
<li><strong>Documentation:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/doc/index.html">fluent-cms-admin.azurewebsites.net/doc/index.html</a>  </li>
</ul>
<h3 id="examples-source-code">Examples Source Code</h3>
<p>example code can be found at /formCMS/examples</p>
<ul>
<li>for Sqlite: run the SqliteDemo project</li>
<li>for SqlServer: run the SqlServerDemo/SqlServerAppHost project</li>
<li>for PostgreSQL : run the PostgresDemo/PostgresAppHost project</li>
</ul>
<p>Defult login:<br />
  - Eamil : <code>samdmin@cms.com</code><br />
  - Password: <code>Admin1!</code>  </p>
<p>After login to <code>Admin Panel</code>, you can go to <code>Tasks</code>, click <code>Import Demo Data</code>, to import demo data.</p>
<hr />
<h2 id="online-course-system-backend">Online Course System Backend</h2>
<p>This section provides detailed guidance on developing a foundational online course system, encompassing key entities: <code>teacher</code>, <code>course</code>, <code>lesson</code>,<code>skill</code>, and <code>material</code>.</p>
<h3 id="database-schema">Database Schema</h3>
<h4 id="1-teachers-table">1. <strong>Teachers Table</strong></h4>
<p>The <code>Teachers</code> table maintains information about instructors, including their personal and professional details.</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Header</strong></th>
<th><strong>Data Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>ID</td>
<td>Int</td>
</tr>
<tr>
<td><code>firstname</code></td>
<td>First Name</td>
<td>String</td>
</tr>
<tr>
<td><code>lastname</code></td>
<td>Last Name</td>
<td>String</td>
</tr>
<tr>
<td><code>email</code></td>
<td>Email</td>
<td>String</td>
</tr>
<tr>
<td><code>phone_number</code></td>
<td>Phone Number</td>
<td>String</td>
</tr>
<tr>
<td><code>image</code></td>
<td>Image</td>
<td>String</td>
</tr>
<tr>
<td><code>bio</code></td>
<td>Bio</td>
<td>Text</td>
</tr>
</tbody>
</table>
<h4 id="2-courses-table">2. <strong>Courses Table</strong></h4>
<p>The <code>Courses</code> table captures the details of educational offerings, including their scope, duration, and prerequisites.</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Header</strong></th>
<th><strong>Data Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>ID</td>
<td>Int</td>
</tr>
<tr>
<td><code>name</code></td>
<td>Course Name</td>
<td>String</td>
</tr>
<tr>
<td><code>status</code></td>
<td>Status</td>
<td>String</td>
</tr>
<tr>
<td><code>level</code></td>
<td>Level</td>
<td>String</td>
</tr>
<tr>
<td><code>summary</code></td>
<td>Summary</td>
<td>String</td>
</tr>
<tr>
<td><code>image</code></td>
<td>Image</td>
<td>String</td>
</tr>
<tr>
<td><code>desc</code></td>
<td>Description</td>
<td>Text</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>Duration</td>
<td>String</td>
</tr>
<tr>
<td><code>start_date</code></td>
<td>Start Date</td>
<td>Datetime</td>
</tr>
</tbody>
</table>
<h4 id="3-lessons-table">3. <strong>Lessons Table</strong></h4>
<p>The <code>Lessons</code> table contains detailed information about the lessons within a course, including their title, content, and associated teacher.</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Header</strong></th>
<th><strong>Data Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>ID</td>
<td>Int</td>
</tr>
<tr>
<td><code>name</code></td>
<td>Lesson Name</td>
<td>String</td>
</tr>
<tr>
<td><code>description</code></td>
<td>Description</td>
<td>Text</td>
</tr>
<tr>
<td><code>teacher</code></td>
<td>Teacher</td>
<td>Int (Foreign Key)</td>
</tr>
<tr>
<td><code>course</code></td>
<td>Course</td>
<td>Int (Foreign Key)</td>
</tr>
<tr>
<td><code>created_at</code></td>
<td>Created At</td>
<td>Datetime</td>
</tr>
<tr>
<td><code>updated_at</code></td>
<td>Updated At</td>
<td>Datetime</td>
</tr>
</tbody>
</table>
<h4 id="4-skills-table">4. <strong>Skills Table</strong></h4>
<p>The <code>Skills</code> table records competencies attributed to teachers.</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Header</strong></th>
<th><strong>Data Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>ID</td>
<td>Int</td>
</tr>
<tr>
<td><code>name</code></td>
<td>Skill Name</td>
<td>String</td>
</tr>
<tr>
<td><code>years</code></td>
<td>Years of Experience</td>
<td>Int</td>
</tr>
<tr>
<td><code>created_by</code></td>
<td>Created By</td>
<td>String</td>
</tr>
<tr>
<td><code>created_at</code></td>
<td>Created At</td>
<td>Datetime</td>
</tr>
<tr>
<td><code>updated_at</code></td>
<td>Updated At</td>
<td>Datetime</td>
</tr>
</tbody>
</table>
<h4 id="5-materials-table">5. <strong>Materials Table</strong></h4>
<p>The <code>Materials</code> table inventories resources linked to courses.</p>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Header</strong></th>
<th><strong>Data Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>ID</td>
<td>Int</td>
</tr>
<tr>
<td><code>name</code></td>
<td>Name</td>
<td>String</td>
</tr>
<tr>
<td><code>type</code></td>
<td>Type</td>
<td>String</td>
</tr>
<tr>
<td><code>image</code></td>
<td>Image</td>
<td>String</td>
</tr>
<tr>
<td><code>link</code></td>
<td>Link</td>
<td>String</td>
</tr>
<tr>
<td><code>file</code></td>
<td>File</td>
<td>String</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="relationships">Relationships</h3>
<ul>
<li><strong>Courses to Teachers</strong>: Man-to-One(Each teacher can teach multiple courses; each course is assigned to one teacher. A teacher can exist independently of a course).</li>
<li><strong>Teachers to Skills</strong>: Many-to-Many (Multiple teachers can share skills, and one teacher may have multiple skills).</li>
<li><strong>Courses to Materials</strong>: Many-to-Many (A course may include multiple materials, and the same material can be used in different courses).</li>
<li><strong>Courses to Lessons</strong>: One-to-Many (Each course can have multiple lessons, but each lesson belongs to one course. A lesson cannot exist without a course, as it has no meaning on its own).</li>
</ul>
<hr />
<h3 id="schema-creation-via-formcms-schema-builder">Schema Creation via FormCMS Schema Builder</h3>
<h4 id="accessing-schema-builder">Accessing Schema Builder</h4>
<p>After launching the web application, locate the <strong>Schema Builder</strong> menu on the homepage to start defining your schema.</p>
<h4 id="adding-entities">Adding Entities</h4>
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/list.html?schema=entity">Example Configuration</a><br />
1. Navigate to the <strong>Entities</strong> section of the Schema Builder.
2. Create entities such as "Teacher" and "Course."
3. For the <code>Course</code> entity, add attributes such as <code>name</code>, <code>status</code>, <code>level</code>, and <code>description</code>.</p>
<hr />
<h3 id="defining-relationships">Defining Relationships</h3>
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=27">Example Configuration</a>  </p>
<h4 id="1-course-and-teacher-many-to-one-relationship">1. <strong>Course and Teacher (Many-to-One Relationship)</strong></h4>
<p>To establish a many-to-one relationship between the <code>Course</code> and <code>Teacher</code> entities, you can include a <code>Lookup</code> attribute in the <code>Course</code> entity. This allows selecting a single <code>Teacher</code> record when adding or updating a <code>Course</code>.</p>
<table>
<thead>
<tr>
<th><strong>Attribute</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Field</strong></td>
<td><code>teacher</code></td>
</tr>
<tr>
<td><strong>DataType</strong></td>
<td>Lookup</td>
</tr>
<tr>
<td><strong>DisplayType</strong></td>
<td>Lookup</td>
</tr>
<tr>
<td><strong>Options</strong></td>
<td>Teacher</td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> When a course is created or modified, a teacher record can be looked up and linked to the course.</p>
<h4 id="2-course-and-lessonone-to-many-relationship">2 <strong>Course and Lesson(One-to-Many Relationship)</strong></h4>
<p>To establish a one-to-many relationship between the <code>Course</code> and <code>Lesson</code> entities, use a <code>Collection</code> attribute in the <code>Course</code> entity. This enables associating multiple lessons with a single course.</p>
<table>
<thead>
<tr>
<th><strong>Attribute</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Field</strong></td>
<td><code>lessons</code></td>
</tr>
<tr>
<td><strong>DataType</strong></td>
<td>Collection</td>
</tr>
<tr>
<td><strong>DisplayType</strong></td>
<td>EditTable</td>
</tr>
<tr>
<td><strong>Options</strong></td>
<td>Lesson</td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> When managing a course , you can manage lessons of this course.</p>
<h4 id="3-course-and-materials-many-to-many-relationship">3. <strong>Course and Materials (Many-to-Many Relationship)</strong></h4>
<p>To establish a many-to-many relationship between the <code>Course</code> and <code>Material</code> entities, use a <code>Junction</code> attribute in the <code>Course</code> entity. This enables associating multiple materials with a single course.</p>
<table>
<thead>
<tr>
<th><strong>Attribute</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Field</strong></td>
<td><code>materials</code></td>
</tr>
<tr>
<td><strong>DataType</strong></td>
<td>Junction</td>
</tr>
<tr>
<td><strong>DisplayType</strong></td>
<td>Picklist</td>
</tr>
<tr>
<td><strong>Options</strong></td>
<td>Material</td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> When managing a course, you can select multiple material records from the <code>Material</code> table to associate with the course.</p>
<hr />
<h2 id="admin-panel"><strong>Admin Panel</strong></h2>
<p>The last chapter introduced how to model entities, this chapter introduction how to use Admin-Panel to manage data of those entities.</p>
<h3 id="display-types"><strong>Display Types</strong></h3>
<p>The Admin Panel supports various UI controls to display attributes:</p>
<ul>
<li><code>"text"</code>: Single-line text input.</li>
<li><code>"textarea"</code>: Multi-line text input.</li>
<li>
<p><code>"editor"</code>: Rich text input.</p>
</li>
<li>
<p><code>"number"</code>: Single-line text input for numeric values only.</p>
</li>
<li><code>"datetime"</code>: Datetime picker for date and time inputs.</li>
<li>
<p><code>"date"</code>: Date picker for date-only inputs.</p>
</li>
<li>
<p><code>"image"</code>: Upload a single image, storing the image URL.</p>
</li>
<li><code>"gallery"</code>: Upload multiple images, storing their URLs.</li>
<li>
<p><code>"file"</code>: Upload a file, storing the file URL.</p>
</li>
<li>
<p><code>"dropdown"</code>: Select an item from a predefined list.</p>
</li>
<li>
<p><code>"multiselect"</code>: Select multiple items from a predefined list.</p>
</li>
<li>
<p><code>"lookup"</code>: Select an item from another entity with a many-to-one relationship (requires <code>Lookup</code> data type).</p>
</li>
<li>
<p><code>"treeSelect"</code>: Select an item from another entity with a many-to-one relationship (requires <code>Lookup</code> data type), items are organized as tree.</p>
</li>
<li>
<p><code>"picklist"</code>: Select multiple items from another entity with a many-to-many relationship (requires <code>Junction</code> data type).</p>
</li>
<li><code>"tree"</code>: Select multiple items from another entity with a many-to-many relationship (requires <code>Junction</code> data type), items are organized as a tree.</li>
<li><code>"edittable"</code>: Manage items of a one-to-many sub-entity (requires <code>Collection</code> data type).  </li>
</ul>
<hr />
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=103">See this example how to configure entity <code>category</code>, so it's item can be organized as tree.</a></p>
<h3 id="datatype-to-displaytype-mapping-table"><strong>DataType to DisplayType Mapping Table</strong></h3>
<p>Below is a mapping of valid <code>DataType</code> and <code>DisplayType</code> combinations:</p>
<table>
<thead>
<tr>
<th><strong>DataType</strong></th>
<th><strong>DisplayType</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Int</td>
<td>Number</td>
<td>Input for integers.</td>
</tr>
<tr>
<td>Datetime</td>
<td>Datetime</td>
<td>Datetime picker for date and time inputs.</td>
</tr>
<tr>
<td>Datetime</td>
<td>Date</td>
<td>Date picker for date-only inputs.</td>
</tr>
<tr>
<td>String</td>
<td>Number</td>
<td>Input for numeric values.</td>
</tr>
<tr>
<td>String</td>
<td>Datetime</td>
<td>Datetime picker for date and time inputs.</td>
</tr>
<tr>
<td>String</td>
<td>Date</td>
<td>Date picker for date-only inputs.</td>
</tr>
<tr>
<td>String</td>
<td>Text</td>
<td>Single-line text input.</td>
</tr>
<tr>
<td>String</td>
<td>Textarea</td>
<td>Multi-line text input.</td>
</tr>
<tr>
<td>String</td>
<td>Image</td>
<td>Single image upload.</td>
</tr>
<tr>
<td>String</td>
<td>Gallery</td>
<td>Multiple image uploads.</td>
</tr>
<tr>
<td>String</td>
<td>File</td>
<td>File upload.</td>
</tr>
<tr>
<td>String</td>
<td>Dropdown</td>
<td>Select an item from a predefined list.</td>
</tr>
<tr>
<td>String</td>
<td>Multiselect</td>
<td>Select multiple items from a predefined list.</td>
</tr>
<tr>
<td>Text</td>
<td>Multiselect</td>
<td>Select multiple items from a predefined list.</td>
</tr>
<tr>
<td>Text</td>
<td>Gallery</td>
<td>Multiple image uploads.</td>
</tr>
<tr>
<td>Text</td>
<td>Textarea</td>
<td>Multi-line text input.</td>
</tr>
<tr>
<td>Text</td>
<td>Editor</td>
<td>Rich text editor.</td>
</tr>
<tr>
<td>Lookup</td>
<td>Lookup</td>
<td>Select an item from another entity.</td>
</tr>
<tr>
<td>Lookup</td>
<td>TreeSelect</td>
<td>Select an item from another entity.</td>
</tr>
<tr>
<td>Junction</td>
<td>Picklist</td>
<td>Select multiple items from another entity.</td>
</tr>
<tr>
<td>Lookup</td>
<td>Tree</td>
<td>Select multiple items from another entity.</td>
</tr>
<tr>
<td>Collection</td>
<td>EditTable</td>
<td>Manage items of a sub-entity.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="list-page"><strong>List Page</strong></h3>
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course?offset=0&amp;limit=20">Example Course List Page</a></p>
<p>The <strong>List Page</strong> displays entities in a tabular format, supporting sorting, searching, and pagination for efficient browsing or locating of specific records.</p>
<h4 id="sorting"><strong>Sorting</strong></h4>
<p>Sort records by clicking the <code>‚Üë</code> or <code>‚Üì</code> icon in the table header.
- <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course?offset=0&amp;limit=20&amp;sort[created_at]=-1">Order by Created At Example</a>
- <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course?offset=0&amp;limit=20&amp;sort[name]=1">Order by Name Example</a></p>
<h4 id="filtering"><strong>Filtering</strong></h4>
<p>Apply filters by clicking the Funnel icon in the table header.</p>
<ul>
<li><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course?offset=0&amp;limit=20&amp;created_at[dateIs]=2024-09-07&amp;sort[created_at]=1">Filter by Created At (2024-09-07)</a></li>
<li><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course?offset=0&amp;limit=20&amp;name[operator]=or&amp;name[startsWith]=A&amp;name[startsWith]=C&amp;sort[created_at]=1">Filter by Course Name (Starts with A or C)</a></li>
</ul>
<h4 id="duplicate"><strong>Duplicate</strong></h4>
<p>Clicking the duplicate button opens the "Add New Data" page with prefilled values from the selected record for quick entry.</p>
<hr />
<h3 id="detail-page"><strong>Detail Page</strong></h3>
<p>Detail page provides an interface to manage single record.  </p>
<h4 id="example-of-display-types-dateimage-gallery-muliselect-dropdown">Example of display types <code>date</code>,<code>image</code>, <code>gallery</code>, <code>muliselect</code>, <code>dropdown</code>,</h4>
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/lesson/6?ref=https%3A%2F%2Ffluent-cms-admin.azurewebsites.net%2F_content%FormCMS%2Fadmin%2Fentities%2Fcourse%2F27%3Fref%3Dhttps%253A%252F%252Ffluent-cms-admin.azurewebsites.net%252F_content%FormCMS%252Fadmin%252Fentities%252Fcourse%253Foffset%253D0%2526limit%253D20">Lesson Detail Page</a>.</p>
<h4 id="example-of-lookuppicklistedittable">Example of <code>lookup</code>,<code>picklist</code>,<code>edittable</code></h4>
<p><a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course/22">Course Detail Page</a></p>
<hr />
<h2 id="publish-preview-content">Publish / Preview Content</h2>
<p>This feature allows content creators to plan and organize their work, saving drafts for later completion.</p>
<h3 id="content-publication-status">Content Publication Status</h3>
<p>Content can have one of the following publication statuses:
- <strong><code>draft</code></strong>
- <strong><code>scheduled</code></strong>
- <strong><code>published</code></strong>
- <strong><code>unpublished</code></strong></p>
<p>Only content with the status <strong><code>published</code></strong> can be retrieved through GraphQL queries.</p>
<hr />
<h3 id="setting-default-publication-status-in-the-schema-builder">Setting Default Publication Status in the Schema Builder</h3>
<p>When defining an entity in the Schema Builder, you can configure its default publication status as either <strong><code>draft</code></strong> or <strong><code>published</code></strong>.</p>
<hr />
<h3 id="managing-publication-status-in-the-admin-panel">Managing Publication Status in the Admin Panel</h3>
<p>On the content edit page, you can:
- <strong>Publish</strong>: Make content immediately available.
- <strong>Unpublish</strong>: Remove content from public view.
- <strong>Schedule</strong>: Set a specific date and time for the content to be published.</p>
<hr />
<h3 id="preview-draftscheduledunpublished-content">Preview Draft/Scheduled/Unpublished Content</h3>
<p>By default, only published content appears in query results. 
If you want to preview how the content looks on a page before publishing, you can add the query parameter <code>preview=1</code> to the page URL.</p>
<p>For a more convenient approach, you can set the <strong>Preview URL</strong> in the <strong>Entity Settings</strong> page. 
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=27">Example Entity Settings Page</a></p>
<p>Once set, you can navigate to the <strong>Entity Management</strong> page and simply click the <strong>Preview</strong> button to view the content in preview mode.
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/admin/entities/course/3?ref=https%3A%2F%2Ffluent-cms-admin.azurewebsites.net%2F_content%2FFormCMS%2Fadmin%2Fentities%2Fcourse%3Foffset%3D0%26limit%3D20#">Example Content Manage Page</a></p>
<hr />
<h3 id="publication-worker">Publication Worker</h3>
<p>The <strong>Publication Worker</strong> automates the process of updating scheduled items in batches, transitioning them to the <strong><code>published</code></strong> status at the appropriate time.</p>
<hr />
<h2 id="concurrent-update-protection">Concurrent Update Protection</h2>
<p>Protect user from dirty write(concurrent update)</p>
<h3 id="how-does-it-work">How does it work?</h3>
<p>Return the updated_at timestamp when fetching the item. When updating, compare the stored updated_at with the one in the request. If they differ, reject the update</p>
<h3 id="when-is-updatedat-checked">When Is updatedAt Checked</h3>
<ul>
<li>During updates</li>
<li>During Deletions</li>
</ul>
<p>If a concurrent modification is detected, the system will throw the following exception:<br />
"Error: Concurrent Write Detected. Someone else has modified this item since you last accessed it. Please refresh the data and try again."</p>
<hr />
<h2 id="audit-logging">Audit Logging</h2>
<p>Audit logging in FormCMS helps maintain accountability and provides a historical record of modifications made to entities within the system. </p>
<h3 id="audit-log-entity">Audit Log Entity</h3>
<p>An audit log entry captures essential information about each modification. The entity structure includes the following fields:</p>
<ul>
<li><strong>UserId</strong> (<em>string</em>): The unique identifier of the user performing the action.</li>
<li><strong>UserName</strong> (<em>string</em>): The name of the user.</li>
<li><strong>Action</strong> (<em>ActionType</em>): The type of action (Create, update, Delete) performed. </li>
<li><strong>EntityName</strong> (<em>string</em>): The name of the entity affected.</li>
<li><strong>RecordId</strong> (<em>string</em>): The unique identifier of the record modified.</li>
<li><strong>RecordLabel</strong> (<em>string</em>): A human-readable label for the record.</li>
<li><strong>Payload</strong> (<em>Record</em>): The data associated with the action.</li>
<li><strong>CreatedAt</strong> (<em>DateTime</em>): The timestamp when the action occurred.</li>
</ul>
<h3 id="when-is-audit-log-added">When Is Audit Log Added</h3>
<p>An audit log entry is created when a user performs any of the following actions:</p>
<ul>
<li><strong>Creating</strong> a new record.</li>
<li><strong>Updating</strong> an existing record.</li>
<li><strong>Deleting</strong> a record.</li>
</ul>
<h3 id="how-to-view-audit-log">How to view Audit Log</h3>
<p>Audit logs can be accessed and searched by users with appropriate permissions. The following roles have access:</p>
<ul>
<li><strong>Admin</strong></li>
<li><strong>Super Admin</strong></li>
</ul>
<p>These users can:
- View a list of audit logs.
- Search logs by user, entity, or action type.
- Filter logs by date range.</p>
<h3 id="benefits-of-audit-logging">Benefits of Audit Logging</h3>
<ul>
<li>Ensures transparency and accountability.</li>
<li>Helps with troubleshooting and debugging.</li>
<li>Provides insights into system usage and modifications.</li>
<li>Supports compliance with regulatory requirements.</li>
</ul>
<p>By maintaining a detailed audit trail, the System enhances security and operational efficiency, ensuring that all modifications are tracked and can be reviewed when necessary.</p>
<hr />
<h2 id="export-and-import-data">Export and Import Data</h2>
<p>This feature allows you to export or import data</p>
<p>This feature is helpful for the following scenarios:<br />
1. Migrating data from one server to another, or even between different types of databases. <br />
2. Backing up your data. <br />
3. Cleaning data by exporting only the latest schema, excluding audit log data.   </p>
<h3 id="exporting-data">Exporting Data</h3>
<ol>
<li>Log in to the 'Admin Panel' and navigate to <code>Tasks</code>.</li>
<li>Click <code>Add Export Task</code>.</li>
<li>Wait a few minutes, then refresh the page. Once the task is complete, you can download the exported zip file.</li>
</ol>
<h3 id="importing-data">Importing Data</h3>
<ol>
<li>Log in to the 'Admin Panel' and go to <code>Tasks</code>.</li>
<li>Click <code>Add Import Task</code>, then select the zip file you wish to import.</li>
<li>Wait a few minutes, then refresh the page to check if the task was successful.</li>
</ol>
<h2 id="asset-library">Asset Library</h2>
<p>The Asset Library tracks uploaded assets (images, files, etc.), enabling reuse across the system, optimizing storage, and providing robust management capabilities.</p>
<p>The system maintains a centralized repository of assets, each represented by the <code>Asset</code> record with metadata, usage tracking, and linking capabilities. Assets are uniquely identified by a <code>Path</code> (e.g., a combination of a <code>yyyy-MM</code> date and ULID), and their relationships to other data entities are tracked via <code>AssetLink</code> records. For images, the system automatically resizes them to optimize storage space, using a default maximum width of 1200 pixels and a compression quality of 75, configurable via system settings.</p>
<h3 id="key-features">Key Features</h3>
<h4 id="add-asset-to-data">Add Asset to Data</h4>
<p>In data management forms, fields for <code>image</code>, <code>file</code>, or <code>gallery</code> inputs provide the following options: </p>
<ul>
<li><strong>Choose File</strong>: Uploads a new file to the server. The system generates a unique <code>Path</code> (e.g., <code>2025-03-abc123</code>), assigns a fixed <code>Url</code> based on the <code>Path</code>, and records the <code>Name</code> (original filename), <code>Size</code>, <code>Type</code>, and <code>CreatedBy</code> metadata. For images, the system resizes the file to a maximum width of 1200 pixels (configurable via <code>ImageCompressionOptions.MaxWidth</code>) with a compression quality of 75 (configurable via <code>ImageCompressionOptions.Quality</code>) before saving, updating the <code>Size</code> accordingly. The <code>CreatedAt</code> timestamp is set to the upload time, and a default <code>Title</code> is derived from the <code>Name</code>. </li>
<li><strong>Choose Library</strong>: Opens a dialog to select an existing asset from the library. The dialog offers: <ul>
<li><code>Gallery View</code>: Displays assets as thumbnails (ideal for images). </li>
<li><code>List View</code>: Shows assets in a tabular format with details like <code>Name</code>, <code>Title</code>, <code>Size</code>, <code>CreatedAt</code>, and <code>Type</code>. Users can filter by Name (e.g., search by keyword), Size (e.g., range of bytes), and CreatedAt (e.g., date range), and order the list by these fields in ascending or descending order. </li>
<li>Selecting an asset links it to the current data entity, incrementing its <code>LinkCount</code> and adding an <code>AssetLink</code> entry. </li>
</ul>
</li>
<li><strong>Delete</strong>: Removes the asset reference from the current data entity by clearing its path, potentially reducing the asset‚Äôs <code>LinkCount</code>. </li>
</ul>
<h4 id="delete-orphan-assets">Delete Orphan Assets</h4>
<p>On the <strong>Asset List Page</strong>, users can view all assets with details such as <code>Name</code>, <code>Title</code>, <code>Size</code>, <code>Type</code>, <code>CreatedAt</code>, and <code>LinkCount</code> (the number of data entities referencing the asset). Assets with a <code>LinkCount</code> of 0 (orphans) can be deleted to free up storage. Deletion removes the asset‚Äôs file and its record from the system.</p>
<h4 id="replace-file">Replace File</h4>
<p>On the <strong>Asset Detail Page</strong>, users can upload a new file to replace an existing asset‚Äôs content:<br />
- The new file updates the asset‚Äôs <code>Size</code>, <code>Type</code>, and <code>UpdatedAt</code> timestamp.<br />
- For images, the system resizes the new file to a maximum width of 1200 pixels (configurable via <code>ImageCompressionOptions.MaxWidth</code>) with a compression quality of 75 (configurable via <code>ImageCompressionOptions.Quality</code>) before saving.<br />
- The <code>Path</code> and <code>Url</code> remain unchanged, ensuring existing references remain valid.<br />
- All data entities linked to the asset (via <code>AssetLink</code>) automatically use the new file content when accessing the fixed <code>Url</code>.   </p>
<h4 id="update-metadata">Update Metadata</h4>
<p>The <strong>Asset Detail Page</strong> allows users to modify an asset‚Äôs metadata:<br />
- <strong>Title</strong>: Edit the <code>Title</code> field (defaults to <code>Name</code> on creation). This can serve as a display name, link title, or caption (e.g., for images in galleries).<br />
- <strong>Metadata Dictionary</strong>: Add or update key-value pairs in the <code>Metadata</code> record to store custom information (e.g., <code>{"AltText": "Description", "Category": "Marketing"}</code>).<br />
- Changes to metadata update the <code>UpdatedAt</code> timestamp.  </p>
<h3 id="data-structure">Data Structure</h3>
<ul>
<li><strong>Asset</strong>: Represents a stored file with fields like <code>Path</code> (unique identifier), <code>Url</code> (fixed access location), <code>Name</code>, <code>Title</code>, <code>Size</code>, <code>Type</code>, <code>Metadata</code>, <code>CreatedBy</code>, <code>CreatedAt</code>, <code>UpdatedAt</code>, <code>Id</code>, <code>LinkCount</code> (calculated), and <code>Links</code> (calculated array of <code>AssetLink</code>). </li>
<li><strong>AssetLink</strong>: Tracks relationships between assets and data entities, with fields like <code>EntityName</code> (e.g., "BlogPost"), <code>RecordId</code> (entity‚Äôs ID), <code>AssetId</code>, <code>CreatedAt</code>, <code>UpdatedAt</code>, and <code>Id</code>. </li>
</ul>
<h3 id="configuration">Configuration</h3>
<ul>
<li><strong>Image Compression</strong>: Controlled via <code>ImageCompressionOptions</code> in <code>SystemSettings</code>: <ul>
<li><code>MaxWidth</code>: Defaults to 1200 pixels; can be overridden to adjust the maximum width of resized images. </li>
<li><code>Quality</code>: Defaults to 75 (on a 0-100 scale); can be adjusted to balance file size and image clarity. </li>
</ul>
</li>
<li><strong>Asset URL</strong>: The <code>Url</code> is prefixed with <code>/files</code> by default (configurable via <code>SystemSettings.AssetUrlPrefix</code>), ensuring a consistent access pattern (e.g., <code>/files/2025-03-abc123</code>). </li>
</ul>
<h3 id="benefits">Benefits</h3>
<ul>
<li><strong>Reuse</strong>: Assets can be shared across multiple data entities, reducing redundancy. </li>
<li><strong>Storage Optimization</strong>: Orphaned assets can be removed, and configurable image resizing (e.g., max width 1200px, quality 75) minimizes storage usage. </li>
<li><strong>Consistency</strong>: The fixed <code>Url</code> ensures seamless updates when replacing files, maintaining all existing links. </li>
<li><strong>Flexibility</strong>: Metadata, file replacement, and adjustable compression settings allow assets to evolve without breaking references. </li>
<li><strong>Tracking</strong>: <code>LinkCount</code> and <code>AssetLink</code> provide visibility into asset usage. </li>
</ul>
<hr />
<h2 id="graphql-query"><strong>GraphQL Query</strong></h2>
<p>FormCMS simplifies frontend development by offering robust GraphQL support.</p>
<h3 id="getting-started">Getting Started</h3>
<h4 id="accessing-the-graphql-ide">Accessing the GraphQL IDE</h4>
<p>To get started, launch the web application and navigate to <code>/graph</code>. You can also try our <a href="https://fluent-cms-admin.azurewebsites.net/graph">online demo</a>.</p>
<hr />
<h4 id="singular-vs-list-response">Singular vs. List Response</h4>
<p>For each entity in FormCMS, two GraphQL fields are automatically generated:<br />
- <code>&lt;entityName&gt;</code>: Returns a record.
- <code>&lt;entityNameList&gt;</code>: Returns a list of records.  </p>
<p>**Single Course **</p>
<pre><code class="language-graphql">{
  course {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20course%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<p>**List of Courses **</p>
<pre><code class="language-graphql">{
  courseList {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<hr />
<h4 id="field-selection">Field Selection</h4>
<p>You can query specific fields for both the current entity and its related entities.
<strong>Example Query:</strong></p>
<pre><code class="language-graphql">{
  courseList{
    id
    name
    teacher{
      id
      firstname
      lastname
      skills{
        id
        name
      }
    }
    materials{
      id,
      name
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList%7B%0A%20%20%20%20id%0A%20%20%20%20name%0A%20%20%20%20teacher%7B%0A%20%20%20%20%20%20id%0A%20%20%20%20%20%20firstname%0A%20%20%20%20%20%20lastname%0A%20%20%20%20%20%20skills%7B%0A%20%20%20%20%20%20%20%20id%0A%20%20%20%20%20%20%20%20name%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20materials%7B%0A%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20name%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<hr />
<h4 id="filtering-with-value-match-in-formcms">Filtering with <code>Value Match</code> in FormCMS</h4>
<p>FormCMS provides flexible filtering capabilities using the <code>idSet</code> field (or any other field), enabling precise data queries by matching either a single value or a list of values.</p>
<p><strong>Filter by a Single Value Example:</strong></p>
<pre><code class="language-graphql">{
  courseList(idSet: 5) {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(idSet%3A5)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<p><strong>Filter by Multiple Values Example:</strong></p>
<pre><code class="language-graphql">{
  courseList(idSet: [5, 7]) {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(idSet%3A%5B5%2C7%5D)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<hr />
<h4 id="advanced-filtering-with-operator-match-in-formcms">Advanced Filtering with <code>Operator Match</code> in FormCMS</h4>
<p>FormCMS supports advanced filtering options with <code>Operator Match</code>, allowing users to combine various conditions for precise queries.</p>
<h5 id="matchall-example"><code>matchAll</code> Example:</h5>
<p>Filters where all specified conditions must be true.<br />
In this example: <code>id &gt; 5 and id &lt; 15</code>.</p>
<pre><code class="language-graphql">{
  courseList(id: {matchType: matchAll, gt: 5, lt: 15}) {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(id%3A%7BmatchType%3AmatchAll%2Cgt%3A5%2Clt%3A15%7D)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<h5 id="matchany-example"><code>matchAny</code> Example:</h5>
<p>Filters where at least one of the conditions must be true.<br />
In this example: <code>name starts with "A"</code> or <code>name starts with "I"</code>.</p>
<pre><code class="language-graphql">{
  courseList(name: [{matchType: matchAny}, {startsWith: &quot;A&quot;}, {startsWith: &quot;I&quot;}]) {
    id
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(name%3A%5B%7BmatchType%3AmatchAny%7D%2C%20%7BstartsWith%3A%22A%22%7D%2C%7BstartsWith%3A%22I%22%7D%5D)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<hr />
<h4 id="filter-expressions-in-formcms"><code>Filter Expressions</code> in FormCMS</h4>
<p>Filter Expressions allow precise filtering by specifying a field, including nested fields using JSON path syntax. This enables filtering on subfields for complex data structures.</p>
<p><strong><em>Example: Filter by Teacher's Last Name</em></strong>
This query returns courses taught by a teacher whose last name is "Circuit."</p>
<pre><code class="language-graphql">{
  courseList(filterExpr: {field: &quot;teacher.lastname&quot;, clause: {equals: &quot;Circuit&quot;}}) {
    id
    name
    teacher {
      id
      lastname
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(filterExpr%3A%20%7Bfield%3A%20%22teacher.lastname%22%2C%20clause%3A%20%7Bequals%3A%20%22Circuit%22%7D%7D)%20%7B%0A%20%20%20%20id%0A%20%20%20%20name%0A%20%20%20%20teacher%20%7B%0A%20%20%20%20%20%20id%0A%20%20%20%20%20%20lastname%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D">Try it here</a></p>
<hr />
<h4 id="sorting_1">Sorting</h4>
<p>Sorting by a single field</p>
<pre><code class="language-graphql">{
  courseList(sort:nameDesc){
    id,
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(sort%3AnameDesc)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<p>Sorting by multiple fields</p>
<pre><code class="language-graphql">{
  courseList(sort:[level,id]){
    id,
    level
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(sort%3A%5Blevel%2Cid%5D)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20level%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A">Try it here</a></p>
<hr />
<h4 id="sort-expressions-in-formcms">Sort Expressions in FormCMS</h4>
<p>Sort Expressions allow sorting by nested fields using JSON path syntax. </p>
<p><strong><em>Example: Sort by Teacher's Last Name</em></strong></p>
<pre><code class="language-graphql">{
  courseList(sortExpr:{field:&quot;teacher.lastname&quot;, order:Desc}) {
    id
    name
    teacher {
      id
      lastname
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%7B%0A%20%20courseList(sortExpr%3A%7Bfield%3A%22teacher.lastname%22%2C%20order%3ADesc%7D)%20%7B%0A%20%20%20%20id%0A%20%20%20%20name%0A%20%20%20%20teacher%20%7B%0A%20%20%20%20%20%20id%0A%20%20%20%20%20%20lastname%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D">Try it here</a></p>
<hr />
<h4 id="pagination">Pagination</h4>
<p>Pagination on root field</p>
<pre><code class="language-graphql">{
  courseList(offset:2, limit:3){
    id,
    name
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%20%20%7B%0A%20%20%20%20courseList(offset%3A2%2C%20limit%3A3)%7B%0A%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20name%0A%20%20%20%20%7D%0A%20%20%7D%0A">Try it here</a> <br />
Pagination on sub field</p>
<pre><code class="language-graphql">{
  courseList{
    id,
    name
    materials(limit:2){
      id,
      name
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=%20%20%7B%0A%20%20%20%20courseList%7B%0A%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20name%0A%20%20%20%20%20%20materials(limit%3A2)%7B%0A%20%20%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20%20%20name%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A">Try it here</a></p>
<hr />
<h4 id="variable">Variable</h4>
<p>Variables are used to make queries more dynamic, reusable, and secure.</p>
<h5 id="variable-in-value-filter">Variable in <code>Value filter</code></h5>
<pre><code>query ($id: Int!) {
  teacher(idSet: [$id]) {
    id
    firstname
    lastname
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24id%3A%20Int!)%20%7B%0A%20%20teacher(idSet%3A%20%5B%24id%5D)%20%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%7D%0A%7D&amp;variables=%7B%0A%20%20%22id%22%3A3%0A%7D">Try it here</a></p>
<h5 id="variable-in-operator-match-filter">Variable in <code>Operator Match</code> filter</h5>
<pre><code>query ($id: Int!) {
  teacherList(id:{equals:$id}){
    id
    firstname
    lastname
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24id%3A%20Int!)%20%7B%0A%20%20teacherList(id%3A%7Bequals%3A%24id%7D)%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%7D%0A%7D&amp;variables=%7B%0A%20%20%22id%22%3A%203%0A%7D">Try it here</a></p>
<h5 id="variable-in-filter-expression">Variable in <code>Filter Expression</code></h5>
<pre><code>query ($years: String) {
  teacherList(filterExpr:{field:&quot;skills.years&quot;,clause:{gt:$years}}){
    id
    firstname
    lastname
    skills{
      id
      name
      years
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24years%3A%20String)%20%7B%0A%20%20teacherList(filterExpr%3A%7Bfield%3A%22skills.years%22%2Cclause%3A%7Bgt%3A%24years%7D%7D)%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%20%20skills%7B%0A%20%20%20%20%20%20id%0A%20%20%20%20%20%20name%0A%20%20%20%20%20%20years%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D&amp;variables=%7B%0A%20%20%22years%22%3A%20%229%22%0A%7D">Try it here</a></p>
<h5 id="variable-in-sort">Variable in Sort</h5>
<pre><code>query ($sort_field:TeacherSortEnum) {
  teacherList(sort:[$sort_field]) {
    id
    firstname
    lastname
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24sort_field%3ATeacherSortEnum)%20%7B%0A%20%20teacherList(sort%3A%5B%24sort_field%5D)%20%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%7D%0A%7D&amp;variables=%7B%22sort_field%22%3A%20%22idDesc%22%7D">Try it here</a></p>
<h5 id="variable-in-sort-expression">Variable in Sort Expression</h5>
<pre><code>query ($sort_order:  SortOrderEnum) {
  courseList(sortExpr:{field:&quot;teacher.id&quot;, order:$sort_order}){
    id,
    name,
    teacher{
      id,
      firstname
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24sort_order%3A%20%20SortOrderEnum)%20%7B%0A%20%20courseList(sortExpr%3A%7Bfield%3A%22teacher.id%22%2C%20order%3A%24sort_order%7D)%7B%0A%20%20%20%20id%2C%0A%20%20%20%20name%2C%0A%20%20%20%20teacher%7B%0A%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20firstname%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D&amp;variables=%7B%0A%20%20%22sort_order%22%3A%20%22Asc%22%0A%7D">Try it here</a></p>
<h5 id="variable-in-pagination">Variable in Pagination</h5>
<pre><code>query ($offset:Int) {
  teacherList(limit:2, offset:$offset) {
    id
    firstname
    lastname
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24offset%3AInt)%20%7B%0A%20%20teacherList(limit%3A2%2C%20offset%3A%24offset)%20%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%7D%0A%7D&amp;variables=%7B%0A%09%22offset%22%3A%202%0A%7D">Try it here</a></p>
<hr />
<h4 id="required-vs-optional">Required vs Optional</h4>
<p>If you want a variable to be mandatory, you can add a  <code>!</code> to the end of the type</p>
<pre><code>query ($id: Int!) {
  teacherList(id:{equals:$id}){
    id
    firstname
    lastname
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20(%24id%3A%20Int!)%20%7B%0A%20%20teacherList(id%3A%7Bequals%3A%24id%7D)%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%7D%0A%7D">Try it here</a></p>
<p>Explore the power of FormCMS GraphQL and streamline your development workflow!</p>
<hr />
<hr />
<h3 id="saved-query">Saved Query</h3>
<p><strong>Realtime queries</strong> may expose excessive technical details, potentially leading to security vulnerabilities.</p>
<p><strong>Saved Queries</strong> address this issue by abstracting the GraphQL query details. They allow clients to provide only variables, enhancing security while retaining full functionality.</p>
<hr />
<h4 id="transitioning-from-real-time-queries-to-saved-queries">Transitioning from <strong>Real-Time Queries</strong> to <strong>Saved Queries</strong></h4>
<h5 id="using-operationname-as-the-saved-query-identifier">Using <code>OperationName</code> as the Saved Query Identifier</h5>
<p>In FormCMS, the <strong>Operation Name</strong> in a GraphQL query serves as a unique identifier for saved queries. For instance, executing the following query automatically saves it as <code>TeacherQuery</code>:</p>
<pre><code class="language-graphql">query TeacherQuery($id: Int) {
  teacherList(idSet: [$id]) {
    id
    firstname
    lastname
    skills {
      id
      name
    }
  }
}
</code></pre>
<p><a href="https://fluent-cms-admin.azurewebsites.net/graph?query=query%20TeacherQuery(%24id%3A%20Int)%20%7B%0A%20%20teacherList(idSet%3A%5B%24id%5D)%7B%0A%20%20%20%20id%0A%20%20%20%20firstname%0A%20%20%20%20lastname%0A%20%20%20%20skills%7B%0A%20%20%20%20%20%20id%2C%0A%20%20%20%20%20%20name%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D&amp;operationName=TeacherQuery">Try it here</a></p>
<hr />
<h5 id="saved-query-endpoints">Saved Query Endpoints</h5>
<p>FormCMS generates two API endpoints for each saved query:</p>
<ol>
<li>
<p><strong>List Records:</strong><br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery</a></p>
</li>
<li>
<p><strong>Single Record:</strong><br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/single">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/single/</a></p>
</li>
</ol>
<hr />
<h5 id="using-rest-api-query-strings-as-variables">Using REST API Query Strings as Variables</h5>
<p>The Saved Query API allows passing variables via query strings:</p>
<ul>
<li>
<p><strong>Single Value:</strong><br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/?id=3">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/?id=3</a></p>
</li>
<li>
<p><strong>Array of Values:</strong><br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?id=3&amp;id=4">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?id=3&amp;id=4</a><br />
  This passes <code>[3, 4]</code> to the <code>idSet</code> argument.</p>
</li>
</ul>
<hr />
<h4 id="additional-features-of-saved-query">Additional Features of <code>Saved Query</code></h4>
<p>Beyond performance and security improvements, <code>Saved Query</code> introduces enhanced functionalities to simplify development workflows.</p>
<hr />
<h5 id="pagination-by-offset">Pagination by <code>offset</code></h5>
<p>Built-in variables <code>offset</code> and <code>limit</code> enable efficient pagination. For example:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=2&amp;offset=2">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=2&amp;offset=2</a></p>
<hr />
<h5 id="offset-pagination-for-subfields"><code>offset</code> Pagination for Subfields</h5>
<p>To display a limited number of subfield items (e.g., the first two skills of a teacher), use the JSON path variable, such as <code>skills.limit</code>:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?skills.limit=2">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?skills.limit=2</a></p>
<hr />
<h5 id="pagination-by-cursor">Pagination by <code>cursor</code></h5>
<p>For large datasets, <code>offset</code> pagination can strain the database. For example, querying with <code>offset=1000&amp;limit=10</code> forces the database to retrieve 1010 records and discard the first 1000.</p>
<p>To address this, <code>Saved Query</code> supports <strong>cursor-based pagination</strong>, which reduces database overhead.<br />
Example response for <a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3</a>:</p>
<pre><code class="language-json">[
  {
    &quot;hasPreviousPage&quot;: false,
    &quot;cursor&quot;: &quot;eyJpZCI6M30&quot;
  },
  {
  },
  {
    &quot;hasNextPage&quot;: true,
    &quot;cursor&quot;: &quot;eyJpZCI6NX0&quot;
  }
]
</code></pre>
<ul>
<li>
<p>If <code>hasNextPage</code> of the last record is <code>true</code>, use the cursor to retrieve the next page:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3&amp;last=eyJpZCI6NX0">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3&amp;last=eyJpZCI6NX0</a></p>
</li>
<li>
<p>Similarly, if <code>hasPreviousPage</code> of the first record is <code>true</code>, use the cursor to retrieve the previous page:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3&amp;first=eyJpZCI6Nn0">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?limit=3&amp;first=eyJpZCI6Nn0</a></p>
</li>
</ul>
<hr />
<h5 id="cursor-based-pagination-for-subfields">Cursor-Based Pagination for Subfields</h5>
<p>Subfields also support cursor-based pagination. For instance, querying <a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?skills.limit=2">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery?skills.limit=2</a> returns a response like this:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 3,
    &quot;firstname&quot;: &quot;Jane&quot;,
    &quot;lastname&quot;: &quot;Debuggins&quot;,
    &quot;hasPreviousPage&quot;: false,
    &quot;skills&quot;: [
      {
        &quot;hasPreviousPage&quot;: false,
        &quot;cursor&quot;: &quot;eyJpZCI6MSwic291cmNlSWQiOjN9&quot;
      },
      {
        &quot;hasNextPage&quot;: true,
        &quot;cursor&quot;: &quot;eyJpZCI6Miwic291cmNlSWQiOjN9&quot;
      }
    ],
    &quot;cursor&quot;: &quot;eyJpZCI6M30&quot;
  }
]
</code></pre>
<p>To fetch the next two skills, use the cursor:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/part/skills?limit=2&amp;last=eyJpZCI6Miwic291cmNlSWQiOjN9">https://fluent-cms-admin.azurewebsites.net/api/queries/TeacherQuery/part/skills?limit=2&amp;last=eyJpZCI6Miwic291cmNlSWQiOjN9</a></p>
<hr />
<h2 id="drag-and-drop-page-designer">Drag and Drop Page Designer</h2>
<p>The page designer utilizes the open-source GrapesJS and Handlebars, enabling seamless binding of <code>GrapesJS Components</code> with <code>FormCMS Queries</code> for dynamic content rendering. </p>
<hr />
<h3 id="page-types-landing-page-detail-page-and-home-page">Page Types: Landing Page, Detail Page, and Home Page</h3>
<h4 id="landing-page"><strong>Landing Page</strong></h4>
<p>A landing page is typically the first page a visitor sees.<br />
- <strong>URL format</strong>: <code>/page/&lt;pagename&gt;</code><br />
- <strong>Structure</strong>: Comprised of multiple sections, each section retrieves data via a <code>query</code>.  </p>
<p><strong>Example</strong>:  <br />
<a href="https://fluent-cms-admin.azurewebsites.net/">Landing Page</a>  <br />
This page fetches data from:<br />
- <a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/?status=featured">https://fluent-cms-admin.azurewebsites.net/api/queries/course/?status=featured</a><br />
- <a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/?level=Advanced">https://fluent-cms-admin.azurewebsites.net/api/queries/course/?level=Advanced</a>  </p>
<hr />
<h4 id="detail-page_1"><strong>Detail Page</strong></h4>
<p>A detail page provides specific information about an item.<br />
- <strong>URL format</strong>: <code>/page/&lt;pagename&gt;/&lt;router parameter&gt;</code><br />
- <strong>Data Retrieval</strong>: FormCMS fetches data by passing the router parameter to a <code>query</code>.  </p>
<p><strong>Example</strong>:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/pages/course/22">Course Detail Page</a><br />
This page fetches data from:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/one?course_id=22">https://fluent-cms-admin.azurewebsites.net/api/queries/course/one?course_id=22</a></p>
<hr />
<h4 id="home-page"><strong>Home Page</strong></h4>
<p>The homepage is a special type of landing page named <code>home</code>.<br />
- <strong>URL format</strong>: <code>/pages/home</code> <br />
- <strong>Special Behavior</strong>: If no other route matches the path <code>/</code>, FormCMS renders <code>/pages/home</code> by default.  </p>
<p><strong>Example</strong>:  <br />
The URL <code>/</code> will be resolved to <code>/pages/home</code> unless explicitly overridden.  </p>
<hr />
<h3 id="introduction-to-grapesjs-panels">Introduction to GrapesJS Panels</h3>
<p>Understanding the panels in GrapesJS is crucial for leveraging FormCMS's customization capabilities in the Page Designer UI. This section explains the purpose of each panel and highlights how FormCMS enhances specific areas to streamline content management and page design. </p>
<p><img alt="GrapesJS Toolbox" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/screenshots/grapes-toolbox.png" /></p>
<ol>
<li>
<p><strong>Style Manager</strong>:</p>
<ul>
<li>Used to customize CSS properties of elements selected on the canvas.</li>
<li><em>FormCMS Integration</em>: This panel is left unchanged by FormCMS, as it already provides powerful styling options.</li>
</ul>
</li>
<li>
<p><strong>Traits Panel</strong>:</p>
<ul>
<li>Allows modification of attributes for selected elements.</li>
<li><em>FormCMS Integration</em>: Custom traits are added to this panel, enabling users to bind data to components dynamically.</li>
</ul>
</li>
<li>
<p><strong>Layers Panel</strong>:</p>
<ul>
<li>Displays a hierarchical view of elements on the page, resembling a DOM tree.</li>
<li><em>FormCMS Integration</em>: While FormCMS does not alter this panel, it‚Äôs helpful for locating and managing FormCMS blocks within complex page designs.</li>
</ul>
</li>
<li>
<p><strong>Blocks Panel</strong>:</p>
<ul>
<li>Contains pre-made components that can be dragged and dropped onto the page.</li>
<li><em>FormCMS Integration</em>: FormCMS enhances this panel by adding custom-designed blocks tailored for its CMS functionality.</li>
</ul>
</li>
</ol>
<p>By familiarizing users with these panels and their integration points, this chapter ensures a smoother workflow and better utilization of FormCMS's advanced page-building tools.</p>
<hr />
<h3 id="data-binding-singleton-or-list">Data Binding: Singleton or List</h3>
<p>FormCMS leverages <a href="https://github.com/Handlebars-Net/Handlebars.Net">Handlebars expressions</a> for dynamic data binding in pages and components.</p>
<hr />
<h4 id="singleton"><strong>Singleton</strong></h4>
<p>Singleton fields are enclosed within <code>{{ }}</code> to dynamically bind individual values.</p>
<ul>
<li><strong>Example Page Settings:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/page.html?schema=page&amp;id=33">Page Schema Settings</a></li>
<li><strong>Example Query:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/?course_id=22">Retrieve Course Data</a></li>
<li><strong>Example Rendered Page:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/pages/course/22">Rendered Course Page</a></li>
</ul>
<hr />
<h4 id="list"><strong>List</strong></h4>
<p><code>Handlebars</code> supports iterating over arrays using the <code>{{#each}}</code> block for repeating data structures.</p>
<pre><code class="language-handlebars">{{#each course}}
    &lt;li&gt;{{title}}&lt;/li&gt;
{{/each}}
</code></pre>
<p>In FormCMS, you won‚Äôt explicitly see the <code>{{#each}}</code> statement in the Page Designer. If a block's data source is set to <code>data-list</code>, the system automatically generates the loop.</p>
<ul>
<li><strong>Example Page Settings:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/page.html?schema=page&amp;id=32">Page Schema Settings</a></li>
<li><strong>Example Rendered Page:</strong> <a href="https://fluent-cms-admin.azurewebsites.net/">Rendered List Page</a></li>
<li><strong>Example Queries:</strong></li>
<li><a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/?status=featured">Featured Courses</a></li>
<li><a href="https://fluent-cms-admin.azurewebsites.net/api/queries/course/?level=Advanced">Advanced Level Courses</a></li>
</ul>
<hr />
<h4 id="steps-to-bind-a-data-source"><strong>Steps to Bind a Data Source</strong></h4>
<p>To bind a <code>Data List</code> to a component, follow these steps:</p>
<ol>
<li>Drag a block from the <strong>Data List</strong> category in the Page Designer.</li>
<li>Open the <strong>Layers Panel</strong> and select the <code>Data List</code> component.</li>
<li>In the <strong>Traits Panel</strong>, configure the following fields:</li>
</ol>
<table>
<thead>
<tr>
<th><strong>Field</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Query</strong></td>
<td>The query to retrieve data.</td>
</tr>
<tr>
<td><strong>Qs</strong></td>
<td>Query string parameters to pass (e.g., <code>?status=featured</code>, <code>?level=Advanced</code>).</td>
</tr>
<tr>
<td><strong>Offset</strong></td>
<td>Number of records to skip.</td>
</tr>
<tr>
<td><strong>Limit</strong></td>
<td>Number of records to retrieve.</td>
</tr>
<tr>
<td><strong>Pagination</strong></td>
<td>Options for displaying content:</td>
</tr>
<tr>
<td></td>
<td>- <strong>Button</strong>: Divides content into multiple pages with navigation buttons (e.g., "Next," "Previous," or numbered buttons).</td>
</tr>
<tr>
<td></td>
<td>- <strong>Infinite Scroll</strong>: Automatically loads more content as users scroll. Ideal for a single component at the bottom of the page.</td>
</tr>
<tr>
<td></td>
<td>- <strong>None</strong>: Displays all available content at once without requiring additional user actions.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="schema-version-control">Schema Version Control</h2>
<p>FormCMS saves each version of schemas, allowing users to roll back to earlier versions. Admins can freely test draft versions, while only published versions take effect.  </p>
<h3 id="requirements">Requirements</h3>
<p>To illustrate this feature, let's take a <code>Page</code> as an example. Once a page is published, it becomes publicly accessible. You may need version control for two main reasons:</p>
<ul>
<li>You want to make changes but ensure they do not take effect until thoroughly tested.</li>
<li>If issues arise in the latest version, you need the ability to roll back to a previous version.</li>
</ul>
<h3 id="choosing-a-version">Choosing a Version</h3>
<p>After making changes, the latest version's status changes to <code>draft</code> in the <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/list.html?type=page">Page List Page</a>.<br />
To manage versions, click the <code>View History</code> button to navigate to the <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/history.html?schemaId=01JKKB85KWA651945N5W0T6PJR">History Version List Page</a>.<br />
Here, you can select any version and set it to <code>published</code> status.</p>
<h3 id="testing-a-draft-version">Testing a <code>Draft</code> Version</h3>
<p>To preview a draft version, append <code>sandbox=1</code> as a query parameter in the URL: <a href="https://fluent-cms-admin.azurewebsites.net/story/?sandbox=1">Preview Draft Version Page</a>.<br />
Alternatively, click the <code>View Page</code> button on the <code>Page Design</code> page.</p>
<h3 id="compare-schema-changes">Compare schema Changes</h3>
<p>You can compare the difference between different versions, use the <a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/diff.html?schemaId=01JKKA93AJG2HNY648H9PC16PN&amp;type=query&amp;oldId=126&amp;newId=138">Schema Diff Tool</a>.</p>
<h3 id="duplicate_1">Duplicate</h3>
<p>You can duplicate any schema version and save it as a new schema.</p>
<hr />
<h2 id="online-course-system-frontend">Online Course System Frontend</h2>
<p>Having established our understanding of FormCMS essentials like Entity, Query, and Page, we're ready to build a frontend for an online course website.</p>
<hr />
<h3 id="key-pages">Key Pages</h3>
<ul>
<li><strong>Home Page (<code>home</code>)</strong>: The main entry point, featuring sections like <em>Featured Courses</em> and <em>Advanced Courses</em>. Each course links to its respective <strong>Course Details</strong> page.</li>
<li><strong>Course Details (<code>course/{course_id}</code>)</strong>: Offers detailed information about a specific course and includes links to the <strong>Teacher Details</strong> page.</li>
<li><strong>Teacher Details (<code>teacher/{teacher_id}</code>)</strong>: Highlights the instructor‚Äôs profile and includes a section displaying their latest courses, which link back to the <strong>Course Details</strong> page.</li>
</ul>
<pre><code class="language-plaintext">             Home Page
                 |
                 |
       +-------------------+
       |                   |
       v                   v
 Latest Courses       Course Details 
       |                   |        
       |                   |       
       v                   v            
Course Details &lt;-------&gt; Teacher Details 
</code></pre>
<hr />
<h3 id="designing-the-home-page">Designing the Home Page</h3>
<ol>
<li><strong>Drag and Drop Components</strong>: Use the  FormCMS page designer to drag a <code>Content-B</code> component.</li>
<li><strong>Set Data Source</strong>: Assign the component's data source to the <code>course</code> query.</li>
<li><strong>Link Course Items</strong>: Configure the link for each course to <code>/pages/course/{{id}}</code>. The Handlebars expression <code>{{id}}</code> is dynamically replaced with the actual course ID during rendering.</li>
</ol>
<p><img alt="Link Example" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/screenshots/designer-link.png" /></p>
<hr />
<h3 id="creating-the-course-details-page">Creating the Course Details Page</h3>
<ol>
<li><strong>Page Setup</strong>: Name the page <code>course/{course_id}</code> to capture the <code>course_id</code> parameter from the URL (e.g., <code>/pages/course/20</code>).</li>
<li><strong>Query Configuration</strong>: The variable <code>{course_id:20}</code> is passed to the <code>course</code> query, generating a <code>WHERE id IN (20)</code> clause to fetch the relevant course data.</li>
<li><strong>Linking to Teacher Details</strong>: Configure the link for each teacher item on this page to <code>/pages/teacher/{{teacher.id}}</code>. Handlebars dynamically replaces <code>{{teacher.id}}</code> with the teacher‚Äôs ID. For example, if a teacher object has an ID of 3, the link renders as <code>/pages/teacher/3</code>.</li>
</ol>
<hr />
<h3 id="creating-the-teacher-details-page">Creating the Teacher Details Page</h3>
<ol>
<li><strong>Page Setup</strong>: Define the page as <code>teacher/{teacher_id}</code> to capture the <code>teacher_id</code> parameter from the URL.</li>
<li><strong>Set Data Source</strong>: Assign the <code>teacher</code> query as the page‚Äôs data source.</li>
</ol>
<h4 id="adding-a-teachers-courses-section">Adding a Teacher‚Äôs Courses Section</h4>
<ul>
<li>Drag a <code>ECommerce A</code> component onto the page.</li>
<li>Set its data source to the <code>course</code> query, filtered by the teacher‚Äôs ID (<code>WHERE teacher IN (3)</code>).</li>
</ul>
<p><img alt="Teacher Page Designer" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/screenshots/designer-teacher.png" /></p>
<p>When rendering the page, the <code>PageService</code> automatically passes the <code>teacher_id</code> (e.g., <code>{teacher_id: 3}</code>) to the query.</p>
<hr />
<h2 id="navigation-by-category">Navigation by Category</h2>
<h3 id="demo-of-category-tree-and-breadcrumb-navigation"><strong>Demo of Category Tree and Breadcrumb Navigation</strong></h3>
<ul>
<li><strong>Category Tree Navigation</strong>:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/course">View Demo</a>  </li>
<li><strong>Breadcrumb Navigation</strong>:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/course/27">View Demo</a>  </li>
</ul>
<hr />
<h3 id="creating-a-category-entity"><strong>Creating a Category Entity</strong></h3>
<p>To create a category entity in the Schema Builder, include <code>parent</code> and <code>children</code> attributes.
- <strong>Example Configuration</strong>:<br />
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=103">Edit Example</a></p>
<hr />
<h3 id="configuration-options-for-navigation"><strong>Configuration Options for Navigation</strong></h3>
<ul>
<li>
<p><strong>DataType: <code>lookup</code></strong> &amp; <strong>DisplayType: <code>TreeSelect</code></strong><br />
  Use this configuration to display a category as a property.<br />
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=96">Edit Example</a></p>
</li>
<li>
<p><strong>DataType: <code>junction</code></strong> &amp; <strong>DisplayType: <code>Tree</code></strong><br />
  Use this configuration to enable category-based navigation.<br />
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/edit.html?schema=entity&amp;id=27">Edit Example</a></p>
</li>
</ul>
<hr />
<h3 id="using-navigation-components-in-page-designer"><strong>Using Navigation Components in Page Designer</strong></h3>
<ul>
<li>
<p><strong>Tree Layer Menu</strong>:<br />
  Use the <code>Tree Layer Menu</code> component for hierarchical navigation.<br />
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/page.html?schema=page&amp;id=42">Edit Example</a></p>
</li>
<li>
<p><strong>Breadcrumbs</strong>:<br />
  Use the <code>Breadcrumbs</code> component to display navigation paths.<br />
<a href="https://fluent-cms-admin.azurewebsites.net/_content/FormCMS/schema-ui/page.html?schema=page&amp;id=33">Edit Example</a></p>
</li>
</ul>
<hr />
<h2 id="optimizing-caching">Optimizing Caching</h2>
<p>FormCMS employs advanced caching strategies to boost performance.  </p>
<p>For detailed information on ASP.NET Core caching, visit the official documentation: <a href="https://learn.microsoft.com/en-us/aspnet/core/performance/caching/overview?view=aspnetcore-9.0">ASP.NET Core Caching Overview</a>.</p>
<h3 id="cache-schema">Cache Schema</h3>
<p>FormCMS automatically invalidates schema caches whenever schema changes are made. The schema cache consists of two types:</p>
<ol>
<li>
<p><strong>Entity Schema Cache</strong><br />
   Caches all entity definitions required to dynamically generate GraphQL types.</p>
</li>
<li>
<p><strong>Query Schema Cache</strong><br />
   Caches query definitions, including dependencies on multiple related entities, to compose efficient SQL queries.</p>
</li>
</ol>
<p>By default, schema caching is implemented using <code>IMemoryCache</code>. However, you can override this by providing a <code>HybridCache</code>. Below is a comparison of the two options:</p>
<h4 id="imemorycache"><strong>IMemoryCache</strong></h4>
<ul>
<li><strong>Advantages</strong>:<ul>
<li>Simple to debug and deploy.</li>
<li>Ideal for single-node web applications.</li>
</ul>
</li>
<li><strong>Disadvantages</strong>:<ul>
<li>Not suitable for distributed environments. Cache invalidation on one node (e.g., Node A) does not propagate to other nodes (e.g., Node B).</li>
</ul>
</li>
</ul>
<h4 id="hybridcache"><strong>HybridCache</strong></h4>
<ul>
<li><strong>Key Features</strong>:<ul>
<li><strong>Scalability</strong>: Combines the speed of local memory caching with the consistency of distributed caching.</li>
<li><strong>Stampede Resolution</strong>: Effectively handles cache stampede scenarios, as verified by its developers.</li>
</ul>
</li>
<li><strong>Limitations</strong>:<br />
  The current implementation lacks "Backend-Assisted Local Cache Invalidation," meaning invalidation on one node does not instantly propagate to others.</li>
<li>** FormCMS Strategy**:<br />
  FormCMS mitigates this limitation by setting the local cache expiration to 20 seconds (one-third of the distributed cache expiration, which is set to 60 seconds). This ensures cache consistency across nodes within 20 seconds, significantly improving upon the typical 60-second delay in memory caching.</li>
</ul>
<p>To implement a <code>HybridCache</code>, use the following code:</p>
<pre><code class="language-csharp">builder.AddRedisDistributedCache(connectionName: CmsConstants.Redis);
builder.Services.AddHybridCache();
</code></pre>
<h3 id="cache-data">Cache Data</h3>
<p>FormCMS does not automatically invalidate data caches. Instead, it leverages ASP.NET Core's output caching for a straightforward implementation. Data caching consists of two types:</p>
<ol>
<li>
<p><strong>Query Data Cache</strong><br />
   Caches the results of queries for faster access.</p>
</li>
<li>
<p><strong>Page Cache</strong><br />
   Caches the output of rendered pages for quick delivery.</p>
</li>
</ol>
<p>By default, output caching is disabled in FormCMS. To enable it, configure and inject the output cache as shown below:</p>
<pre><code class="language-csharp">builder.Services.AddOutputCache(cacheOption =&gt;
{
    cacheOption.AddBasePolicy(policyBuilder =&gt; policyBuilder.Expire(TimeSpan.FromMinutes(1)));
    cacheOption.AddPolicy(CmsOptions.DefaultPageCachePolicyName,
        b =&gt; b.Expire(TimeSpan.FromMinutes(2)));
    cacheOption.AddPolicy(CmsOptions.DefaultQueryCachePolicyName,
        b =&gt; b.Expire(TimeSpan.FromSeconds(1)));
});

// After builder.Build();
app.UseOutputCache();
</code></pre>
<hr />
<h2 id="aspire-integration">Aspire Integration</h2>
<p>FormCMS leverages Aspire to simplify deployment.</p>
<h3 id="architecture-overview">Architecture Overview</h3>
<p>A scalable deployment of  FormCMS involves multiple web application nodes, a Redis server for distributed caching, and a database server, all behind a load balancer.</p>
<pre><code>                 +------------------+
                 |  Load Balancer   |
                 +------------------+
                          |
        +-----------------+-----------------+
        |                                   |
+------------------+              +------------------+
|    Web App 1     |              |    Web App 2     |
|   +-----------+  |              |   +-----------+  |
|   | Local Cache| |              |   | Local Cache| |
+------------------+              +------------------+
        |                                   |
        |                                   |
        +-----------------+-----------------+
                 |                       |
       +------------------+    +------------------+
       | Database Server  |    |   Redis Server   |
       +------------------+    +------------------+
</code></pre>
<hr />
<h3 id="local-emulation-with-aspire-and-service-discovery">Local Emulation with Aspire and Service Discovery</h3>
<p><a href="https://github.com/formcms/formcms/tree/main/server/FormCMS.Course">Example Web project on GitHub</a><br />
<a href="https://github.com/formcms/formcms/tree/main/server/FormCMS.Course.AppHost">Example Aspire project on GitHub</a>  </p>
<p>To emulate the production environment locally,  FormCMS leverages Aspire. Here's an example setup:</p>
<pre><code class="language-csharp">var builder = DistributedApplication.CreateBuilder(args);

// Adding Redis and PostgreSQL services
var redis = builder.AddRedis(name: CmsConstants.Redis);
var db = builder.AddPostgres(CmsConstants.Postgres);

// Configuring the web project with replicas and references
builder.AddProject&lt;Projects.FormCMS_Course&gt;(name: &quot;web&quot;)
    .WithEnvironment(CmsConstants.DatabaseProvider, CmsConstants.Postgres)
    .WithReference(redis)
    .WithReference(db)
    .WithReplicas(2);

builder.Build().Run();
</code></pre>
<h3 id="benefits_1">Benefits:</h3>
<ol>
<li><strong>Simplified Configuration</strong>:<br />
   No need to manually specify endpoints for the database or Redis servers. Configuration values can be retrieved using:
   <code>csharp
   builder.Configuration.GetValue&lt;string&gt;();
   builder.Configuration.GetConnectionString();</code></li>
<li><strong>Realistic Testing</strong>:<br />
   The local environment mirrors the production architecture, ensuring seamless transitions during deployment.</li>
</ol>
<p>By adopting these caching and deployment strategies,  FormCMS ensures improved performance, scalability, and ease of configuration.</p>
<hr />
<h2 id="query-with-document-db">Query with Document DB</h2>
<p>Optimizing query performance by syncing relational data to a document database, such as MongoDB, significantly improves speed and scalability for high-demand applications.</p>
<h3 id="limitations-of-aspnet-core-output-caching">Limitations of ASP.NET Core Output Caching</h3>
<p>ASP.NET Core's output caching reduces database access when repeated queries are performed. However, its effectiveness is limited when dealing with numerous distinct queries:</p>
<ol>
<li>The application server consumes excessive memory to cache data. The same list might be cached multiple times in different orders.</li>
<li>The database server experiences high load when processing numerous distinct queries simultaneously.</li>
</ol>
<h3 id="using-document-databases-to-improve-query-performance">Using Document Databases to Improve Query Performance</h3>
<p>For the query below, FormCMS joins the <code>post</code>, <code>tag</code>, <code>category</code>, and <code>author</code> tables:</p>
<pre><code class="language-graphql">query post_sync($id: Int) {
  postList(idSet: [$id], sort: id) {
    id, title, body, abstract
    tag {
      id, name
    }
    category {
      id, name
    }
    author {
      id, name
    }
  }
}
</code></pre>
<p>By saving each post along with its related data as a single document in a document database, such as MongoDB, several improvements are achieved:
- Reduced database server load since data retrieval from multiple tables is eliminated.
- Reduced application server processing, as merging data is no longer necessary.</p>
<h3 id="performance-testing">Performance Testing</h3>
<p>Using K6 scripts with 1,000 virtual users concurrently accessing the query API, the performance difference between PostgreSQL and MongoDB was tested, showing MongoDB to be significantly faster:</p>
<pre><code class="language-javascript">export default function () {
    const id = Math.floor(Math.random() * 1000000) + 1; // Random id between 1 and 1,000,000
    /* PostgreSQL */
    // const url = `http://localhost:5091/api/queries/post_sync/?id=${id}`;

    /* MongoDB */
    const url = `http://localhost:5091/api/queries/post/?id=${id}`;

    const res = http.get(url);

    check(res, {
        'is status 200': (r) =&gt; r.status === 200,
        'response time is &lt; 200ms': (r) =&gt; r.timings.duration &lt; 200,
    });
}
/*
MongoDB:
     http_req_waiting...............: avg=50.8ms   min=774¬µs    med=24.01ms max=3.23s    p(90)=125.65ms p(95)=211.32ms
PostgreSQL:
     http_req_waiting...............: avg=5.54s   min=11.61ms med=4.08s max=44.67s  p(90)=13.45s  p(95)=16.53s
*/
</code></pre>
<h3 id="synchronizing-query-data-to-document-db">Synchronizing Query Data to Document DB</h3>
<h4 id="architecture-overview_1">Architecture Overview</h4>
<p><img alt="Architecture Overview" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/mongo-sync.png" /></p>
<h4 id="enabling-message-publishing-in-webapp">Enabling Message Publishing in WebApp</h4>
<p>To enable publishing messages to the Message Broker, use Aspire to add a NATS resource. Detailed documentation is available in <a href="https://learn.microsoft.com/en-us/dotnet/aspire/messaging/nats-integration?tabs=dotnet-cli">Microsoft Docs</a>.</p>
<p>Add the following line to the Aspire HostApp project:</p>
<pre><code class="language-csharp">builder.AddNatsClient(AppConstants.Nats);
</code></pre>
<p>Add the following lines to the WebApp project:</p>
<pre><code class="language-csharp">builder.AddNatsClient(AppConstants.Nats);
var entities = builder.Configuration.GetRequiredSection(&quot;TrackingEntities&quot;).Get&lt;string[]&gt;()!;
builder.Services.AddNatsMessageProducer(entities);
</code></pre>
<p>FormCMS publishes events for changes made to entities listed in <code>appsettings.json</code>:</p>
<pre><code class="language-json">{
  &quot;TrackingEntities&quot;: [
    &quot;post&quot;
  ]
}
</code></pre>
<h4 id="enabling-message-consumption-in-worker-app">Enabling Message Consumption in Worker App</h4>
<p>Add the following to the Worker App:</p>
<pre><code class="language-csharp">var builder = Host.CreateApplicationBuilder(args);

builder.AddNatsClient(AppConstants.Nats);
builder.AddMongoDBClient(AppConstants.MongoCms);

var apiLinksArray = builder.Configuration.GetRequiredSection(&quot;ApiLinksArray&quot;).Get&lt;ApiLinks[]&gt;()!;
builder.Services.AddNatsMongoLink(apiLinksArray);
</code></pre>
<p>Define the <code>ApiLinksArray</code> in <code>appsettings.json</code> to specify entity changes and the corresponding query API:</p>
<pre><code class="language-json">{
  &quot;ApiLinksArray&quot;: [
    {
      &quot;Entity&quot;: &quot;post&quot;,
      &quot;Api&quot;: &quot;http://localhost:5001/api/queries/post_sync&quot;,
      &quot;Collection&quot;: &quot;post&quot;,
      &quot;PrimaryKey&quot;: &quot;id&quot;
    }
  ]
}
</code></pre>
<p>When changes occur to the <code>post</code> entity, the Worker Service calls the query API to retrieve aggregated data and saves it as a document.</p>
<h4 id="migrating-query-data-to-document-db">Migrating Query Data to Document DB</h4>
<p>After adding a new entry to <code>ApiLinksArray</code>, the Worker App will perform a migration from the start to populate the Document DB.</p>
<h3 id="replacing-queries-with-document-db">Replacing Queries with Document DB</h3>
<h4 id="architecture-overview_2">Architecture Overview</h4>
<p><img alt="Architecture Overview" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/mongo-query.png" />   </p>
<p>To enable MongoDB queries in your WebApp, use the Aspire MongoDB integration. Details are available in <a href="https://learn.microsoft.com/en-us/dotnet/aspire/database/mongodb-integration?tabs=dotnet-cli">Microsoft Docs</a>.</p>
<p>Add the following code to your WebApp:</p>
<pre><code class="language-csharp">builder.AddMongoDBClient(connectionName: AppConstants.MongoCms);
var queryLinksArray = builder.Configuration.GetRequiredSection(&quot;QueryLinksArray&quot;).Get&lt;QueryLinks[]&gt;()!;
builder.Services.AddMongoDbQuery(queryLinksArray);
</code></pre>
<p>Define <code>QueryLinksArray</code> in <code>appsettings.json</code> to specify MongoDB queries:</p>
<pre><code class="language-json">{
  &quot;QueryLinksArray&quot;: [
    { &quot;Query&quot;: &quot;post&quot;, &quot;Collection&quot;: &quot;post&quot; },
    { &quot;Query&quot;: &quot;post_test_mongo&quot;, &quot;Collection&quot;: &quot;post&quot; }
  ]
}
</code></pre>
<p>The WebApp will now query MongoDB directly for the specified collections.</p>
<hr />
<h2 id="integrating-it-into-your-project">Integrating it into Your Project</h2>
<p>Follow these steps to integrate FormCMS into your project using a NuGet package.</p>
<p>You can reference the code from https://github.com/FormCMS/FormCMS/tree/main/examples</p>
<ol>
<li>
<p><strong>Create a New ASP.NET Core Web Application</strong>.</p>
</li>
<li>
<p><strong>Add the NuGet Package</strong>:
   To add FormCMS, run the following command:<br />
<code>dotnet add package FormCMS</code></p>
</li>
<li>
<p><strong>Modify <code>Program.cs</code></strong>:
   Add the following line before <code>builder.Build()</code> to configure the database connection (use your actual connection string):<br />
<code>builder.AddSqliteCms("Data Source=cms.db");
   var app = builder.Build();</code>
   Currently,  FormCMS supports <code>AddSqliteCms</code>, <code>AddSqlServerCms</code>, and <code>AddPostgresCms</code>.</p>
</li>
<li>
<p><strong>Initialize FormCMS</strong>:
   Add this line after <code>builder.Build()</code> to initialize the CMS:<br />
<code>await app.UseCmsAsync();</code><br />
   This will bootstrap the router and initialize the FormCMS schema table.</p>
</li>
</ol>
<hr />
<h2 id="adding-business-logic">Adding Business Logic</h2>
<p>Learn how to customize your application by adding validation logic, hook functions, and producing events to Kafka.</p>
<h3 id="adding-validation-logic-with-simple-c-expressions">Adding Validation Logic with Simple C# Expressions</h3>
<h4 id="simple-c-validation">Simple C# Validation</h4>
<p>You can define simple C# expressions in the <code>Validation Rule</code> of attributes using <a href="https://github.com/dynamicexpresso/DynamicExpresso">Dynamic Expresso</a>. For example, a rule like <code>name != null</code> ensures the <code>name</code> attribute is not null.</p>
<p>Additionally, you can specify a <code>Validation Error Message</code> to provide users with feedback when validation fails.</p>
<h4 id="using-regular-expressions">Using Regular Expressions</h4>
<p><code>Dynamic Expresso</code> supports regular expressions, allowing you to write rules like <code>Regex.IsMatch(email, "^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$")</code>.</p>
<blockquote>
<p>Note: Since <code>Dynamic Expresso</code> doesn't support <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/verbatim">verbatim strings</a>, you must escape backslashes (<code>\</code>).</p>
</blockquote>
<hr />
<h3 id="extending-functionality-with-hook-functions">Extending Functionality with Hook Functions</h3>
<p>To implement custom business logic, such as verifying that a <code>teacher</code> entity has valid email and phone details, you can register hook functions to run before adding or updating records:</p>
<pre><code class="language-csharp">var registry = app.GetHookRegistry();

// Hook function for pre-add validation
registry.EntityPreAdd.Register(&quot;teacher&quot;, args =&gt;
{
    VerifyTeacher(args.RefRecord);
    return args;
});

// Hook function for pre-update validation
registry.EntityPreUpdate.Register(&quot;teacher&quot;, args =&gt;
{
    VerifyTeacher(args.RefRecord);
    return args;
});
</code></pre>
<hr />
<h3 id="producing-events-to-an-event-broker-eg-kafka">Producing Events to an Event Broker (e.g., Kafka)</h3>
<p>To enable asynchronous business logic through an event broker like Kafka, you can produce events using hook functions. This feature requires just a few additional setup steps:</p>
<ol>
<li>
<p>Add the Kafka producer configuration:
   <code>csharp
   builder.AddKafkaMessageProducer("localhost:9092");</code></p>
</li>
<li>
<p>Register the message producer hook:
   <code>csharp
   app.RegisterMessageProducerHook();</code></p>
</li>
</ol>
<p>Here‚Äôs a complete example:</p>
<pre><code class="language-csharp">builder.AddSqliteCms(&quot;Data Source=cmsapp.db&quot;).PrintVersion();
builder.AddKafkaMessageProducer(&quot;localhost:9092&quot;);
var app = builder.Build();
await app.UseCmsAsync(false);
app.RegisterMessageProducerHook();
</code></pre>
<p>With this setup, events are produced to Kafka, allowing consumers to process business logic asynchronously.</p>
<hr />
<h2 id="development-guide">Development Guide</h2>
<p>The backend is written in ASP.NET Core, the Admin Panel uses React, and the Schema Builder is developed with jQuery.</p>
<h3 id="overview">Overview</h3>
<p>The system comprises three main components:<br />
1. <strong>Backend</strong> - Developed in ASP.NET Core.<br />
2. <strong>Admin Panel</strong> - Built using React.<br />
3. <strong>Schema Builder</strong> - Created with jQuery.  </p>
<h4 id="system-diagram">System Diagram</h4>
<p><img alt="System Overview" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/overview.png" /></p>
<h3 id="repository-links">Repository Links</h3>
<ul>
<li><a href="https://github.com/formcms/formcms/tree/main/server/FormCMS"><strong>Backend Server</strong></a>  </li>
<li><a href="https://github.com/formcms/formcms/tree/main/admin-panel"><strong>Admin Panel UI</strong></a>  </li>
<li><a href="https://github.com/formcms/formcms/tree/main/server/FormCMS/wwwroot/schema-ui"><strong>Schema Builder</strong></a>  </li>
</ul>
<hr />
<h3 id="backend-server">Backend Server</h3>
<h4 id="tools">Tools</h4>
<ul>
<li><strong>ASP.NET Core</strong></li>
<li><strong>SqlKata</strong> (<a href="https://sqlkata.com/">SqlKata Documentation</a>)</li>
</ul>
<h4 id="architecture">Architecture</h4>
<p>The backend is influenced by Domain-Driven Design (DDD).<br />
<img alt="DDD Architecture" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/ddd-architecture.png" /></p>
<p>Code organization follows this diagram:<br />
<img alt="Backend Code Structure" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/C4_Elements-Backend.png" /></p>
<h5 id="core-domain-layer">Core (Domain Layer)</h5>
<p>The <strong>Core layer</strong> encapsulates:
- <strong>Descriptors</strong>: Includes <code>Entity</code>, <code>Filter</code>, <code>Sort</code>, and similar components for building queries.
- <strong>HookFactory</strong>: Maintains a global <code>Hook Registry</code>, enabling developers to integrate custom plugins.</p>
<blockquote>
<p><strong>Note</strong>: The Core layer is independent of both the Application and Infrastructure layers.</p>
</blockquote>
<h5 id="application-layer">Application Layer</h5>
<p>The <strong>Application layer</strong> provides the following functionalities:
1. <strong>CMS</strong>: Entity CRUD, GraphQL Queries, and Page Designer.
2. <strong>Auth</strong>: Manages permissions and roles.
3. <strong>DataLink</strong>: Integrates DocumentDB and Event Streams for scalability.</p>
<blockquote>
<p>Includes <code>Builders</code> to configure Dependency Injection and manage Infrastructure components.</p>
</blockquote>
<h5 id="infrastructure-layer">Infrastructure Layer</h5>
<p>The <strong>Infrastructure layer</strong> defines reusable system infrastructural components.
- Application services depend on interfaces instead of implementations.
- Components are designed for portability and can be reused across other projects.</p>
<h5 id="util-layer">Util Layer</h5>
<p>A separate <strong>Util component</strong> contains static classes with pure functions.
- Accessible across all layers.</p>
<hr />
<h3 id="admin-panel-ui">Admin Panel UI</h3>
<h4 id="tools_1">Tools</h4>
<ul>
<li><strong>React</strong></li>
<li><strong>PrimeReact</strong> (<a href="https://primereact.org/">PrimeReact UI Library</a>)</li>
<li><strong>SWR</strong> (<a href="https://swr.vercel.app/">Data Fetching/State Management</a>)</li>
</ul>
<h4 id="admin-panel-sequence">Admin Panel Sequence</h4>
<p><img alt="Admin Panel Sequence" src="https://raw.githubusercontent.com/formcms/formcms/doc/doc/diagrams/admin-panel-sequence.png" /></p>
<hr />
<h3 id="schema-builder-ui">Schema Builder UI</h3>
<h4 id="tools_2">Tools</h4>
<ul>
<li><strong>jsoneditor</strong> (<a href="https://github.com/json-editor/json-editor">JSON Editor Documentation</a>)</li>
</ul>
<hr />
<h2 id="testing-strategy">Testing Strategy</h2>
<p>This chapter describes the systems' automated testing strategy</p>
<p>Favors integration testing over unit testing because integration tests can catch more real-world issues.
For example, when inserting a record into the database, multiple modules are involved:
- <code>EntitiesHandler</code>
- <code>EntitiesService</code>
- <code>Entity</code> (in core)
- <code>Query executors</code> (e.g., <code>SqlLite</code>, <code>Postgres</code>, <code>SqlServer</code>)</p>
<p>Writing unit tests for each function and mocking its upstream and downstream services can be tedious.
Instead, FormCMS focuses on checking the input and output of RESTful API endpoints in its integration tests.</p>
<h3 id="integration-testing-for-formcmscourse-formcmsserverformcmscoursetests">Integration Testing for FormCMS.Course <code>/formcms/server/FormCMS.Course.Tests</code></h3>
<p>This project focuses on verifying the functionalities of the FormCMS.Course example project.</p>
<h3 id="new-feature-testing-formcmsserverformcmsapptests">New Feature Testing <code>/formcms/server/FormCMS.App.Tests</code></h3>
<p>This project is dedicated to testing experimental functionalities, like MongoDB and Kafka plugins.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js"></script>
        <script src="search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2025-03-08 23:20:41.961133+00:00
-->
